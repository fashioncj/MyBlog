Title: 如何在家用宽带中搭建一个个人网站
Date: 2015-01-25 18:05  
Modified: 2015-01-25 18:05  
Category: Technology Diary
Tags: January,Route
Authors: chenjia.me

本文介绍的是普通电信宽带用户获取公网ip及公开端口的解决方案

# 原料 #
1. 中国大陆普通电信宽带
2. 支持端口转发和DDNS的路由器或者直连电脑
3. 花生壳等ddns服务
4. 本机电脑上开放某端口

# 可以做什么 #
1. 搭建自己的网站
2. 自己电脑架设服务器和别人一起连接
3. 架设samba等文件共享服务器可以在世界各地随时随地访问
4. 远程桌面自己的电脑
5. 。。。

# 教学开始 #
遇到不理解的名词可以评论或者百度之~

## 获得一个独立的公网ip ##
电信用户现在大多都是NATip，也就是很多人的ip是`100.64.*.*`

> 如何查看自己的ip情况呢，打开百度，输入ip搜索，你就会看到自己的ip，然后打开电脑（直接拨号的）或者路由器的设置界面，看拨号的ip是否一致，如果一致则说明是公网ip，如果不是则说明是内网ip

如果是内网ip的话电信用户可以打10000转4报修宽带故障，转人工坐席，告诉他要申请外网ip，他就会给你开通，开通后等几个小时断开宽带重新连接就可以看到效果了。

## 配置DDNS ##
这里以小米路由器mini来说明

首先我们打开[http://www.oray.com/](http://www.oray.com/ "花生壳官网")之类的DDNS服务网站，主要先查看你的路由器支持哪家DDNS服务，注册账号，获得DDNS服务

然后我们将注册的账号密码域名填入路由器设置中，更新时间10分钟到1个小时都可以，强制更新时间一个小时就好，宽带的ip变化其实不是很频繁

配置完成后我们更新域名的dns服务状态，通过`Windows的nslookup 域名或者Linux的dig 域名`看看解析出来的dns是否和宽带的ip一致，dns更新时间和dns服务商有关

如果一致则更新成功

## 配置端口转发 ##
如果你是直连的就无视这一步，如果是路由器的话一台设备的话可以用DMZ全局转发，如果多台设备按照 `协议，开放端口，局域网机器的ip，局域网机器服务的端口`来进行配置，一般80端口都是被路由器占用，配置好后要记得保存让之生效

配置成功后我们可以用`telnet 域名 端口`来测试端口是否成功

## 绑定自己的域名 ##
如果你申请了自己的域名可以将某一个二级域名的DNS添加一条记录`CNAME`到配置好的域名就ok了~dig的时候就可以看到CNAME的跳转了

## 然后配置本机的服务 ##
比如游戏服务器的端口，远程桌面的3389，ssh的22端口，goagent的8087~设置好转发就ok~